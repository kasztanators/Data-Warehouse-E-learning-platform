--Compare the average grade of courses with the biggest/lowest number of hours
--lowest
WITH MEMBER [Measures].[AVG GRADE] AS  
[Measures].[Grade - Fact Enrollment] / [Measures].[Grade Count]
SELECT NON EMPTY{ [Measures].[Avreage Grade] } ON 0 
FROM [Uni Learn] 
WHERE [Dim Course].[Num Of Hours].&[15-30]
CELL PROPERTIES VALUE, 
BACK_COLOR, 
FORE_COLOR, 
FORMATTED_VALUE, 
FORMAT_STRING, 
FONT_NAME, 
FONT_SIZE, 
FONT_FLAGS

--biggest
WITH MEMBER [Measures].[AVG GRADE] AS  
[Measures].[Grade - Fact Enrollment] / [Measures].[Grade Count]
SELECT NON EMPTY{ [Measures].[Avreage Grade] } ON 0 
FROM [Uni Learn] 
WHERE [Dim Course].[Num Of Hours].&[106-120]
CELL PROPERTIES VALUE, 
BACK_COLOR, 
FORE_COLOR, 
FORMATTED_VALUE, 
FORMAT_STRING, 
FONT_NAME, 
FONT_SIZE, 
FONT_FLAGS

--Find the average completion percentage for the courses with the biggest/lowest number of hours.
--lowest
WITH MEMBER [Measures].[AVG COMPLETION] AS 
[Measures].[Completition Percentage - Fact Enrollment] / [Measures].[Fact Enrollment Count] 
SELECT NON EMPTY { [Measures].[AVG COMPLETION] } ON 0
FROM [Uni Learn] 
WHERE [Dim Course].[Num Of Hours].&[15-30]
CELL PROPERTIES VALUE, 
BACK_COLOR, 
FORE_COLOR, 
FORMATTED_VALUE, 
FORMAT_STRING, 
FONT_NAME, 
FONT_SIZE, 
FONT_FLAGS
--biggest
WITH MEMBER [Measures].[AVG COMPLETION] AS 
[Measures].[Completition Percentage - Fact Enrollment] / [Measures].[Fact Enrollment Count] 
SELECT NON EMPTY { [Measures].[AVG COMPLETION] } ON 0 
FROM [Uni Learn] 
WHERE [Dim Course].[Num Of Hours].&[106-120]
CELL PROPERTIES VALUE, 
BACK_COLOR, 
FORE_COLOR, 
FORMATTED_VALUE, 
FORMAT_STRING, 
FONT_NAME, 
FONT_SIZE, 
FONT_FLAGS

--Compare average grades from 2015 and 2016
--2015
WITH MEMBER [Measures].[AVG GRADE] AS  
[Measures].[Grade - Fact Enrollment] / [Measures].[Grade Count]
SELECT { [Measures].[Avreage Grade] } ON 0 
From [Uni Learn]
WHERE [ID Start Date].[Year].&[2.015E3]
--2016
WITH MEMBER [Measures].[AVG GRADE] AS  
[Measures].[Grade - Fact Enrollment] / [Measures].[Grade Count]
SELECT { [Measures].[Avreage Grade] }  ON 0 
From [Uni Learn]
WHERE [ID Start Date].[Year].&[2.016E3]

--Which faculty has the lowest/highest average grades
--Lowest
WITH MEMBER [Measures].[AVG GRADE] AS  
[Measures].[Grade - Fact Enrollment] / [Measures].[Grade Count]
SELECT {[Measures].[Avreage Grade]} ON 0,
	BOTTOMCOUNT((NONEMPTY ([Dim Faculty].[Name].[Name])), 1, [Measures].[Avreage Grade]) ON 1
FROM [Uni Learn];
--Highest
WITH MEMBER [Measures].[AVG GRADE] AS  
[Measures].[Grade - Fact Enrollment] / [Measures].[Grade Count]
SELECT {[Measures].[Avreage Grade]} ON 0,
	TOPCOUNT((NONEMPTY ([Dim Faculty].[Name].[Name])), 1, [Measures].[Avreage Grade]) ON 1
FROM [Uni Learn];

--Find the number of hours of courses with the best average rating from the survey

